<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Find the Topological Ordering of parameters — top_order • CausDiscEqVar</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Find the Topological Ordering of parameters — top_order" />

<meta property="og:description" content="Find the Topological Ordering of parameters, which are assumed to come from 
a linear SEM (also known as SCM) where it is assumed that the independent 
noise terms have equal error variance." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CausDiscEqVar</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Simulations.html">Simulation study</a>
    </li>
    <li>
      <a href="../articles/Theory.html">Theory</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Find the Topological Ordering of parameters</h1>
    
    <div class="hidden name"><code>top_order.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Find the Topological Ordering of parameters, which are assumed to come from 
a linear SEM (also known as SCM) where it is assumed that the independent 
noise terms have equal error variance.</p>
    
    </div>

    <pre class="usage"><span class='fu'>top_order</span>(<span class='no'>X</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"TD"</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>A matrix containing the oberved variables.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>The estimation method. Possible choises are "TD", "BU", "HTD"
and "HBU".</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Terms passed to the method specific estimation steps.</p>
<p>If the method "HBU" is specified it is possible to specify a tuning 
  parameter <code>M</code> to be used in the organic lasso.</p>
<p>If the method "HTD" is specified it is posible to specify a 
  <code>max.degree</code> and a <code>search</code>. The <code>max.degree</code> specifies the 
  assumed maximal in-degree in the true causal graph. The parameter 
  <code>search</code> may be set to either "full", "B&amp;B" or "OMP" indicating how 
  the algorithem should search for <code>max.degree</code> number of parameters to 
  produce the lowest conditional variance.</p>  
<p>The "full" search method simply looks at all possible subsets of the 
  current ansestreal set of size <code>max.degree</code>, the "B&amp;B" method searches
  via a bound and branch method, and lastly "OMP" uses orthogonal matching 
  pursuit (forward selection) to find <code>max.degree</code> variables from the 
  ansestreal set.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A vector of length equal to the number of parameters with the 
  estimated topological ordering is returned.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function <code>top_order</code> estimated the topological order of the causal
graph. The method is based on the theory and pseudo code from Chen, Drton and 
Wang (2018). The 4 methods "TD" (Top Down), "BU" (Bottom Up), "HTD" (High 
dimensional Top Down) and "HBU" (High dimensional Bottom Up) are implemented
in this function.</p>
<p>The "TD" and "BU" methods <em>only</em> work when the number of observations 
<code>n</code> is larger then the number of parameters <code>p</code>. Moreover the
consistency results shown in the preprint only hold if \(n &gt; p^2 log(p)\).</p>
<p>The "HTD" and "HBU" both require extra assumption either on the maximal 
in-degree or on the maximal size of markov blankets in the graph respectivly. 
Hence these methods both has parameters that allows the user to tune 
and use different sub procedures that fit the assumptions on the graph.</p>
<p>The "HBU" needs a tuning parameter <code>M</code> which is used in the organic 
lasso to estimate the conditional variance: 
$$\hat{\sigma}^2_{j,\Theta} = \min((1/n)||X_j - X_{V \ (\Theta \cup \{j\})}\beta||_2^2 + 2\lambda||\beta||_1^2)$$
where \(\lambda = (2M(1/n)log(p))^{1/2}\).</p>
<p>The "HTD" needs both a <code>max.degree</code> equal to the assumed maximal 
in-degree in the graph and a <code>search</code> parameter. One of three different 
<code>search</code> procedures "full", "B&amp;B" or "OMP" must be used. All three 
procedures seek to find a subset of variables of size <code>max.degree</code> that
minimize the conditional variance of the current variable in question given 
this subset.</p>
<p>The "full" search method simply goes through all poissible subsets of size 
<code>max.degree</code>. The "B&amp;B" searched by bound and branch methods. Lastly the
"OMP" procedure findes <code>max.degree</code> variables via forward selection. -</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
    <p>Chen, W., Drton, M. &amp; Wang, Y. S. (2018). On Causal Discovery with Equal 
Variance Assumption. <em>arXiv preprint arXiv:1807.03419.</em></p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>The wrapper function <code><a href='graph_est.html'>graph_est</a></code>combines <code>top_order</code> 
  and the model selection function <code><a href='graph_from_top.html'>graph_from_top</a></code> into one 
  function that estimates the causal graph from the data.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>1000</span>
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fl'>5</span>
<span class='no'>sigma</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>

<span class='co'># an example where all nodes in the graph are root nodes</span>
<span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='no'>n</span> * <span class='no'>p</span>, <span class='fl'>0</span>, <span class='no'>sigma</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='no'>p</span>)
<span class='no'>order</span> <span class='kw'>&lt;-</span> <span class='fu'>top_order</span>(<span class='no'>X</span>)

<span class='co'># an example where pa(X_i) = X_j for all j &lt; i</span>
<span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq_len</a></span>(<span class='no'>p</span>)[-<span class='fl'>1</span>]) {
  <span class='no'>X</span>[ ,<span class='no'>i</span>] <span class='kw'>&lt;-</span> <span class='no'>X</span>[ ,<span class='no'>i</span>-<span class='fl'>1</span>] + <span class='no'>X</span>[ ,<span class='no'>i</span>]
}

<span class='fu'>top_order</span>(<span class='no'>X</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"TD"</span>)</div><div class='output co'>#&gt; [1] 1 2 3 4 5</div><div class='input'>
<span class='fu'>top_order</span>(<span class='no'>X</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"BU"</span>)</div><div class='output co'>#&gt; [1] 1 2 3 4 5</div><div class='input'>
<span class='fu'>top_order</span>(<span class='no'>X</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"HTD"</span>, <span class='kw'>max.degree</span> <span class='kw'>=</span> <span class='fl'>2L</span>, <span class='kw'>search</span> <span class='kw'>=</span> <span class='st'>"B&amp;B"</span>)</div><div class='output co'>#&gt; [1] 1 2 3 4 5</div><div class='input'>
<span class='fu'>top_order</span>(<span class='no'>X</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"HBU"</span>)</div><div class='output co'>#&gt; [1] 1 3 4 2 5</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Anna Laksafoss.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

